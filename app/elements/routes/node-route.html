<dom-module id="node-route">
  <style>
    paper-material {
      background-color: white;
      min-height: 120px;
      max-width: 720px;
      margin: 0px auto;
    }

    :host .container {
      padding: 2em;
    }
  </style>
  <template>
    <meta-route load href="{{computeNodeHref(routeParams)}}" expand="user,text" meta-response="{{node}}">

      <page-info title="{{node.title}}"></page-info>

      <paper-material elevation="1">
        <div class="container">

          <h1>{{node.title}}</h1>

          <meta-resource model="{{node.text}}">
            <render-remarkable input="{{node.text.content}}"></render-remarkable>
          </meta-resource>

          <node-settings node="{{node}}"></node-settings>
        </div>
      </paper-material>

    </meta-route>
  </template>
  <script>
    Polymer({
      is: "node-route",

      properties: {
        routeParams: {
          type: Object,
          notify: true,
          observer: "routeParamsSet"
        },
        node: {
          type: Object,
          notify: true
        }
      },

      routeParamsSet: function(routeParams) {
        if(!this.node && routeParams.name && window.nodesCache && window.nodesCache[routeParams.name]) {
          this.node = window.nodesCache[routeParams.name];
        }
      },

      computeNodeHref: function (routeParams) {
        return "/api/nodes/" + routeParams.name;
      }


    });
  </script>
</dom-module>